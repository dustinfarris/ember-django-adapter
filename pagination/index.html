<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Pagination - Ember Django Adapter</title>
  

  <link rel="shortcut icon" href="../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Pagination";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script> 

  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-13275015-13', 'auto');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Ember Django Adapter</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="..">Introduction</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../configuring/">Configuring</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../extending/">Extending</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../trailing-slashes/">Trailing Slashes</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../embedded-records/">Embedded Records</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 current">
        <a class="current" href="./">Pagination</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#pagination">Pagination</a></li>
                
                    <li><a class="toctree-l4" href="#accessing-the-metadata">Accessing the Metadata</a></li>
                
                    <li><a class="toctree-l4" href="#pagination-metadata">Pagination Metadata</a></li>
                
                    <li><a class="toctree-l4" href="#customizing-the-metadata">Customizing the Metadata</a></li>
                
                    <li><a class="toctree-l4" href="#cursor-pagination">Cursor Pagination</a></li>
                
            
            </ul>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../coalesce-find-requests/">Coalesce Find Requests</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../hyperlinked-related-fields/">Hyperlinked Related Fields</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../contributing/">Contributing</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../changelog/">Changelog</a>
        
    </li>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Ember Django Adapter</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Pagination</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/dustinfarris/ember-django-adapter" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="pagination">Pagination</h1>
<p>Pagination is supported using the metadata support that is built into Ember Data.
Metadata from Django REST Framework paginated list views is updated on every request
to the server.</p>
<p>The pagination support in EDA works with the default pagination setup in DRF 3.0 and the
<a href="http://www.django-rest-framework.org/api-guide/pagination/#pagenumberpagination">PageNumberPagination</a>
class in DRF 3.1. It's possible to use the other DRF 3.1 pagination classes by
overriding <code>extractMeta</code> (see <a href="#customizing-the-metadata">customizing the Metadata</a> below).</p>
<h2 id="accessing-the-metadata">Accessing the Metadata</h2>
<p>To get a page of records, simply run a <code>query</code> request with the <code>page</code> query param.</p>
<pre><code class="js">let result = this.store.query('post', {page: 1});
</code></pre>

<p>All of the DRF metadata (including the pagination metadata) can be access through the
<code>meta</code> property of the result once the promise is fulfilled.</p>
<pre><code class="js">let meta = result.get('meta');
</code></pre>

<p><strong>Note:</strong> The <code>meta</code> property will only be set on results of <code>query</code> requests.</p>
<h2 id="pagination-metadata">Pagination Metadata</h2>
<p>The pagination metadata consists of three properties that give the application enough
information to paginate through a Django REST Framework paginated list view.</p>
<ul>
<li><code>next</code> - The next page number or <code>null</code> when there is no next page (i.e. the last
           page).</li>
<li><code>previous</code> - The previous page number or <code>null</code> when there is no previous page (i.e.
               the first page).</li>
<li><code>count</code> - The total number of records available. This can be used along with the page
            size to calculate the total number of pages (see
            <a href="#customizing-the-metadata">customizing the Metadata</a> below).</li>
</ul>
<p>The <code>next</code> and <code>previous</code> page number can be used directly as the value of the <code>page</code>
query param. <code>null</code> is not a valid value for the <code>page</code> query param so applications need
to check if <code>next</code> and <code>previous</code> are null before using them.</p>
<pre><code class="js">if (meta.next) {
  result = store.query('post', {page: meta.next})
}
</code></pre>

<h2 id="customizing-the-metadata">Customizing the Metadata</h2>
<p>You can customize the metadata by overriding the <code>extractMeta</code> and adding and / or removing
metadata as indicated in this template.</p>
<pre><code class="js">// app/serializer/&lt;model&gt;.js

import Ember from 'ember';
import DRFSerializer from './drf';

export default DRFSerializer.extend({
  extractMeta: function(store, type, payload) {
    let meta = this._super(store, type, payload);
    if (!Ember.isNone(meta)) {

      // Add or remove metadata here.

    }
    return meta;
  }
});
</code></pre>

<p>This version of <code>extractMeta</code> adds the total page count to the <code>post</code> metadata.</p>
<pre><code class="js">// app/serializer/post.js

import Ember from 'ember';
import DRFSerializer from './drf';

export default DRFSerializer.extend({
  extractMeta: function(store, type, payload) {
    let meta = this._super(store, type, payload);
    if (!Ember.isNone(meta)) {
      // Add totalPages to metadata.
      let totalPages = 1;
      if (!Ember.isNone(meta.next)) {
        // Any page that is not the last page.
        totalPages = Math.ceil(meta.count / payload.results.length);
      } else if (Ember.isNone(meta.next) &amp;&amp; !Ember.isNone(meta.previous)) {
        // The last page when there is more than one page.
        totalPages = meta.previous + 1;
      }
      meta['totalPages'] = totalPages;
    }
    return meta;
  }
});
</code></pre>

<h2 id="cursor-pagination">Cursor Pagination</h2>
<p>To use <a href="http://www.django-rest-framework.org/api-guide/pagination/#cursorpagination"><code>CursorPagination</code></a>, override <code>extractPageNumber</code> in the serializer to extract the <code>cursor</code>.</p>
<pre><code class="js">// app/serializer/drf.js

import DRFSerializer from 'ember-django-adapter/serializers/drf';

export default DRFSerializer.extend({
  extractPageNumber: function(url) {
    var match = /.*?[\?&amp;]cursor=([A-Za-z0-9]+).*?/.exec(url);
    if (match) {
      return match[1];
    }
    return null;
  }
});
</code></pre>

<p>If you don't use the <code>PageNumberPagination</code> for pagination with DRF 3.1 you can also add
the metadata for the pagination scheme you use here. We may add support for the other
pagination classes in the future. If this is something you are interested in contributing,
please file an issue on github.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../coalesce-find-requests/" class="btn btn-neutral float-right" title="Coalesce Find Requests"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../embedded-records/" class="btn btn-neutral" title="Embedded Records"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../embedded-records/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../coalesce-find-requests/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
